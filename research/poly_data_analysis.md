# Polymarket Data Collection - warproxxx/poly_data åˆ†æ

**é …ç›®åœ°å€**: https://github.com/warproxxx/poly_data  
**Stars**: 279 | **Forks**: 66  
**æœ€å¾Œæ›´æ–°**: 2å€‹æœˆå‰

---

## æ ¸å¿ƒåŠŸèƒ½

### 1. ä¸‰éšæ®µæ•¸æ“šç®¡é“

#### Stage 1: å¸‚å ´æ•¸æ“šæ”¶é›† (`update_markets.py`)
- å¾ Polymarket API æŒ‰æ™‚é–“é †åºç²å–æ‰€æœ‰å¸‚å ´
- è‡ªå‹•å¾ä¸Šæ¬¡ä¸­æ–·è™•æ¢å¾©ï¼ˆidempotentï¼‰
- æ‰¹é‡ç²å–ï¼ˆæ¯æ¬¡ 500 å€‹å¸‚å ´ï¼‰
- é€Ÿç‡é™åˆ¶å’ŒéŒ¯èª¤è™•ç†

#### Stage 2: è¨‚å–®äº‹ä»¶æŠ“å– (`update_goldsky.py`)
- å¾ Goldsky subgraph API æŠ“å– order-filled äº‹ä»¶
- è‡ªå‹•å¾æœ€å¾Œæ™‚é–“æˆ³æ¢å¾©
- GraphQL æŸ¥è©¢åˆ†é è™•ç†
- äº‹ä»¶å»é‡

#### Stage 3: äº¤æ˜“è™•ç† (`process_live.py`)
- å°‡åŸå§‹è¨‚å–®äº‹ä»¶è½‰æ›ç‚ºçµæ§‹åŒ–äº¤æ˜“æ•¸æ“š
- ä½¿ç”¨ token lookup å°‡ asset ID æ˜ å°„åˆ°å¸‚å ´
- è¨ˆç®—åƒ¹æ ¼å’Œäº¤æ˜“æ–¹å‘
- è­˜åˆ¥ BUY/SELL æ–¹å‘
- è‡ªå‹•ç™¼ç¾ç¼ºå¤±çš„å¸‚å ´
- å¢é‡è™•ç†ï¼ˆå¾ä¸Šæ¬¡æª¢æŸ¥é»ç¹¼çºŒï¼‰

---

## æ•¸æ“šçµæ§‹

### markets.csv
**æ¬„ä½**:
- `createdAt`, `id`, `question`
- `answer1`, `answer2`, `neg_risk`
- `market_slug`, `token1`, `token2`
- `condition_id`, `volume`, `ticker`
- `closedTime`

### goldsky/orderFilled.csv
**æ¬„ä½**:
- `timestamp`, `maker`, `makerAssetId`, `makerAmountFilled`
- `taker`, `takerAssetId`, `takerAmountFilled`
- `transactionHash`

### processed/trades.csv
**æ¬„ä½**:
- `timestamp`, `market_id`
- `maker`, `taker`
- `nonusdc_side`, `maker_direction`, `taker_direction`
- `price`, `usd_amount`, `token_amount`
- `transactionHash`

---

## é—œéµæŠ€è¡“ç‰¹é»

### 1. å¯æ¢å¾©æ“ä½œ
- **Markets**: è¨ˆç®—ç¾æœ‰ CSV è¡Œæ•¸è¨­ç½® offset
- **Goldsky**: å¾ orderFilled.csv è®€å–æœ€å¾Œæ™‚é–“æˆ³
- **Processing**: æ‰¾åˆ°æœ€å¾Œè™•ç†çš„äº¤æ˜“å“ˆå¸Œ

### 2. éŒ¯èª¤è™•ç†
- ç¶²çµ¡å¤±æ•—è‡ªå‹•é‡è©¦
- é€Ÿç‡é™åˆ¶æª¢æ¸¬å’Œé€€é¿
- æœå‹™å™¨éŒ¯èª¤ï¼ˆ500ï¼‰è™•ç†
- ç¼ºå¤±æ•¸æ“šçš„å„ªé›…é™ç´š

### 3. ç¼ºå¤±å¸‚å ´ç™¼ç¾
- è™•ç†éšæ®µè‡ªå‹•ç™¼ç¾åˆå§‹ markets.csv ä¸­æ²’æœ‰çš„å¸‚å ´
- é€šé Polymarket API ç²å–ä¸¦ä¿å­˜åˆ° `missing_markets.csv`

### 4. åœ°å€å’Œè³‡ç”¢è¿½è¹¤
- å¹³å°éŒ¢åŒ…åœ°å€è¿½è¹¤ï¼ˆåœ¨ `poly_utils/utils.py`ï¼‰:
  - `0xc5d563a36ae78145c45a50134d48a1215220f80a`
  - `0x4bfb41d5b3570defd03c39a9a4d8de6bd8b8982e`
- USDC å’Œ outcome token ID è­˜åˆ¥:
  - "0" ä»£è¡¨ USDC
  - éé›¶ ID ä»£è¡¨ outcome tokens

---

## è™•ç†é‚è¼¯

### äº¤æ˜“è™•ç†æµç¨‹
1. è­˜åˆ¥æ¯ç­†äº¤æ˜“ä¸­çš„é USDC è³‡ç”¢
2. æ˜ å°„åˆ°å¸‚å ´å’Œ outcome token (token1/token2)
3. ç¢ºå®š maker/taker æ–¹å‘ (BUY/SELL)
4. è¨ˆç®—åƒ¹æ ¼ = USDC é‡‘é¡ / outcome token æ•¸é‡
5. å°‡é‡‘é¡å¾åŸå§‹å–®ä½è½‰æ›ï¼ˆé™¤ä»¥ 10^6ï¼‰

### æ•¸æ“šæ¨™æº–åŒ–
- æ‰€æœ‰é‡‘é¡æ¨™æº–åŒ–ç‚ºåé€²åˆ¶æ ¼å¼ï¼ˆé™¤ä»¥ 10^6ï¼‰
- æ™‚é–“æˆ³å¾ Unix epoch è½‰æ›ç‚º datetime
- è² é¢¨éšªå¸‚å ´åœ¨å¸‚å ´æ•¸æ“šä¸­æ¨™è¨˜

---

## å°æˆ‘å€‘é …ç›®çš„åƒ¹å€¼

### âœ… å„ªé»
1. **å®Œæ•´çš„æ•¸æ“šç®¡é“** - å¾å¸‚å ´åˆ°äº¤æ˜“çš„å®Œæ•´æµç¨‹
2. **å¯æ¢å¾©æ€§** - é©åˆé•·æœŸé‹è¡Œå’Œæ•¸æ“šæ›´æ–°
3. **éŒ¯èª¤è™•ç†** - ç”Ÿç”¢ç´šçš„éŒ¯èª¤è™•ç†æ©Ÿåˆ¶
4. **åœ°å€è¿½è¹¤** - å·²ç¶“å¯¦ç¾å¹³å°éŒ¢åŒ…è¿½è¹¤
5. **Goldsky é›†æˆ** - ä½¿ç”¨ subgraph ç²å–æ›´å®Œæ•´çš„æ•¸æ“š

### ğŸ¯ å¯å€Ÿé‘’çš„æŠ€è¡“
1. **Goldsky Subgraph API** - æ¯”å®˜æ–¹ API æ›´å®Œæ•´çš„æ•¸æ“šæº
2. **å¢é‡æ›´æ–°æ©Ÿåˆ¶** - å¾ä¸Šæ¬¡ä¸­æ–·è™•æ¢å¾©
3. **ç¼ºå¤±å¸‚å ´ç™¼ç¾** - è‡ªå‹•è£œå…¨ç¼ºå¤±çš„å¸‚å ´æ•¸æ“š
4. **äº¤æ˜“è™•ç†é‚è¼¯** - åƒ¹æ ¼è¨ˆç®—å’Œæ–¹å‘åˆ¤æ–·
5. **å¹³å°éŒ¢åŒ…è­˜åˆ¥** - ç”¨æ–¼éæ¿¾å…§éƒ¨äº¤æ˜“

### ğŸ“‹ å¯æ•´åˆçš„ä»£ç¢¼
1. `update_goldsky.py` - Goldsky API é›†æˆ
2. `process_live.py` - äº¤æ˜“è™•ç†é‚è¼¯
3. `poly_utils/utils.py` - å·¥å…·å‡½æ•¸å’Œå¸¸é‡
4. éŒ¯èª¤è™•ç†å’Œé‡è©¦æ©Ÿåˆ¶
5. å¢é‡æ›´æ–°é‚è¼¯

---

## ä¸‹ä¸€æ­¥è¡Œå‹•

### 1. æ·±å…¥ç ”ç©¶ä»£ç¢¼
- [ ] ä¸‹è¼‰ä¸¦åˆ†æ `update_goldsky.py`
- [ ] ç ”ç©¶ `process_live.py` çš„äº¤æ˜“è™•ç†é‚è¼¯
- [ ] æŸ¥çœ‹ `poly_utils/utils.py` çš„å·¥å…·å‡½æ•¸

### 2. æ•´åˆåˆ°æˆ‘å€‘çš„ç³»çµ±
- [ ] å°‡ Goldsky API é›†æˆåˆ° Python å¾Œç«¯
- [ ] å¯¦ç¾å¢é‡æ›´æ–°æ©Ÿåˆ¶
- [ ] æ·»åŠ ç¼ºå¤±å¸‚å ´è‡ªå‹•ç™¼ç¾
- [ ] å„ªåŒ–äº¤æ˜“è™•ç†æµç¨‹

### 3. æ“´å±•åŠŸèƒ½
- [ ] æ·»åŠ åœ°å€è¡Œç‚ºåˆ†æ
- [ ] å¯¦ç¾å·¨é¯¨è­˜åˆ¥ç®—æ³•
- [ ] å»ºç«‹å¯ç–‘äº¤æ˜“æª¢æ¸¬è¦å‰‡
- [ ] å¯¦ç¾å¯¦æ™‚æ•¸æ“šæ›´æ–°
